## Challenge Name: PIE TIME
Category: Binary Exploitation
Difficulty: Easy

### Challenge Description
Can you try to get the flag? Beware we have PIE!
Connect to the program with netcat:
$ nc rescued-float.picoctf.net 50767
The program's source code can be downloaded here. The binary can be downloaded here.


Find the JPG file in `Files/`, named *img*, and extract the flag.

---

## Files:
* [img](Files/img.jpg)

---

### Approach

### 1. Inspecting the PDF Metadata:
Since the image didn't immediately reveal anything, I started by checking its metadataâ€”a common first step in forensics challenges. I used exiftool, which is essential for inspecting the hidden data embedded within files.

```bash
exiftool img.jpg
```

This revealed several fields. Crucially, the Comment field contained a long, unusual string (c3RlZ2hpZGU6Y0VGNmVuZHZjbVE9). Ordinary image files usually don't have a comment, or if they do, it's human-readable text. The presence of this seemingly random string immediately indicated it was the hidden payload.

![Metadata Output](./chall_images/Metadata_output.png)

### 2. Decoding the Suspicious Comment Field
The Comment field contained what looked like a Base64-encoded string: c3RlZ2hpZGU6Y0VGNmVuZHZjbVE9
A quick decode was necessary:
```bash 
echo "c3RlZ2hpZGU6Y0VGNmVuZHZjbVE9" | base64 -d
```

Obtaining: 
```bash 
steghide:cEF6endvcmQ=
```

This output was a clear hint! It suggested using the steghide tool and revealed a second, nested Base64 string (cEF6endvcmQ=) which was likely the password needed. I decoded the second string:
```bash 
echo "cEF6endvcmQ=" | base64 -d
```

I successfully obtained the final password: pAzzword

### 3. Extracting the Hidden Payload
Since the initial hint (steghide:) pointed to it, the final step is to use the steghide tool to extract the hidden content from the img.jpg file using the discovered password.
```bash 
steghide extract -sf img.jpg -p pAzzword
Output: wrote extracted data to "flag.txt".
```

The tool confirmed that a file named flag.txt was successfully extracted. Let's view its content:
```bash 
cat flag.txt
picoCTF{h1dd3n_1n_1m4g3_f051f2e8}
```

Flag successfully recovered ðŸŽ‰



### Reflections
This challenge was a great introduction to the basics of Steganography and file Forensics.
- The first and most critical step is always inspecting metadata using tools like exiftool. Fields such as Comment are frequently misused to hide clues or payloads.
- The challenge employed a nested decoding structure, where the first Base64 decode gave the tool hint (steghide) and the second Base64 string yielded the password. This is a common pattern to be aware of in CTFs.
- This write-up allowed me to successfully practice using the following essential tools: exiftool , base64, steghide

---
[Back to home](<https://github.com/pedroandrem/CTF/tree/main/picoCTF>)
